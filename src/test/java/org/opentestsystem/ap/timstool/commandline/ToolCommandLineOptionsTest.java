package org.opentestsystem.ap.timstool.commandline;

import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;
import org.junit.Before;
import org.junit.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class ToolCommandLineOptionsTest {

    ToolCommandLineOptions toolCommandLineOptions;

    @Before
    public void setUp() {
        toolCommandLineOptions = new ToolCommandLineOptions();
    }

    @Test
    public void getOptions() {
        Options options = toolCommandLineOptions.getOptions();
        assertThat(options.getOptions()).hasSize(5);
    }

    @Test
    public void getHelp() {
        Option option = toolCommandLineOptions.getHelp();
        assertOptions(option, "h", "help", false, "Prints this message.");
    }

    @Test
    public void getCommands() {
        Option option = toolCommandLineOptions.getCommands();
        assertOptions(option, "c", "commands", false, "Lists the tool commands.");
    }

    @Test
    public void getInputFile() {
        Option option = toolCommandLineOptions.getInputFile();
        assertOptions(option, "i", "input", true, "Specifies the input file.");
        assertThat(option.getArgName()).isEqualTo("file");
    }

    @Test
    public void getOutputFile() {
        Option option = toolCommandLineOptions.getOutputFile();
        assertOptions(option, "o", "output", true, "Specifies the output file.");
        assertThat(option.getArgName()).isEqualTo("file");
    }

    @Test
    public void getAuthToken() {
        Option option = toolCommandLineOptions.getAuthToken();
        assertOptions(option, "t", "token", true, "Specifies the authorization token.");
        assertThat(option.getArgName()).isEqualTo("auth-token");
    }

    private void assertOptions(Option option, String opt, String longOpt, boolean hasArg, String desc) {
        assertThat(option.getOpt()).isEqualTo(opt);
        assertThat(option.getLongOpt()).isEqualTo(longOpt);
        assertThat(option.hasArg()).isEqualTo(hasArg);
        assertThat(option.getDescription()).isEqualTo(desc);
    }
}